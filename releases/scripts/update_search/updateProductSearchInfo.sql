delete from PRODUCT_SEARCH_INFO;
insert into PRODUCT_SEARCH_INFO (PRODUCT_ID, MERCHANT_ID,CATEGORY_ID,QUALITY_SCORE,PRODUCT_DIAMOND,PRODUCT_AUDIT,LAST_UPT_TIME)
    select p.PRODUCT_ID, p.MERCHANT_ID, pcat.CATEGORY_ID, p.QUALITY_SCORE, p.PRODUCT_DIAMOND, p.PRODUCT_AUDIT, NULL 
    from PRODUCT p left join MERCHANT_STORE m on p.MERCHANT_ID=m.MERCHANT_ID
        left join PRODUCT_CATEGORY pcat on p.PRODUCT_ID=pcat.PRODUCT_ID left join CATEGORY cat on cat.CATEGORY_ID=pcat.CATEGORY_ID;

update PRODUCT_SEARCH_INFO p inner join (select p2.PRODUCT_ID as PRODUCT_ID,  p2.SKU as SKU, p2.CAS as CAS, p2.CODE as CODE, pdscp.NAME as NAME, pdscp.EN_NAME as EN_NAME, m.STORE_NAME as STORE_NAME from PRODUCT_SEARCH_INFO p1 left join PRODUCT p2 on p1.PRODUCT_ID=p2.PRODUCT_ID left join PRODUCT_DESCRIPTION pdscp on p2.PRODUCT_ID=pdscp.PRODUCT_ID left join MERCHANT_STORE m on m.MERCHANT_ID=p2.MERCHANT_ID where p1.SEARCH_CONTENT is null limit 300000) as d on d.PRODUCT_ID=p.PRODUCT_ID set p.SEARCH_CONTENT=concat(IFNULL(d.SKU,''), IFNULL(d.CAS,''), IFNULL(d.CODE,''), IFNULL(d.NAME,''), IFNULL(d.EN_NAME,''), IFNULL(d.STORE_NAME,''));
update PRODUCT_SEARCH_INFO p inner join (select p2.PRODUCT_ID as PRODUCT_ID,  p2.SKU as SKU, p2.CAS as CAS, p2.CODE as CODE, pdscp.NAME as NAME, pdscp.EN_NAME as EN_NAME, m.STORE_NAME as STORE_NAME from PRODUCT_SEARCH_INFO p1 left join PRODUCT p2 on p1.PRODUCT_ID=p2.PRODUCT_ID left join PRODUCT_DESCRIPTION pdscp on p2.PRODUCT_ID=pdscp.PRODUCT_ID left join MERCHANT_STORE m on m.MERCHANT_ID=p2.MERCHANT_ID where p1.SEARCH_CONTENT is null limit 300000) as d on d.PRODUCT_ID=p.PRODUCT_ID set p.SEARCH_CONTENT=concat(IFNULL(d.SKU,''), IFNULL(d.CAS,''), IFNULL(d.CODE,''), IFNULL(d.NAME,''), IFNULL(d.EN_NAME,''), IFNULL(d.STORE_NAME,''));
update PRODUCT_SEARCH_INFO p inner join (select p2.PRODUCT_ID as PRODUCT_ID,  p2.SKU as SKU, p2.CAS as CAS, p2.CODE as CODE, pdscp.NAME as NAME, pdscp.EN_NAME as EN_NAME, m.STORE_NAME as STORE_NAME from PRODUCT_SEARCH_INFO p1 left join PRODUCT p2 on p1.PRODUCT_ID=p2.PRODUCT_ID left join PRODUCT_DESCRIPTION pdscp on p2.PRODUCT_ID=pdscp.PRODUCT_ID left join MERCHANT_STORE m on m.MERCHANT_ID=p2.MERCHANT_ID where p1.SEARCH_CONTENT is null limit 300000) as d on d.PRODUCT_ID=p.PRODUCT_ID set p.SEARCH_CONTENT=concat(IFNULL(d.SKU,''), IFNULL(d.CAS,''), IFNULL(d.CODE,''), IFNULL(d.NAME,''), IFNULL(d.EN_NAME,''), IFNULL(d.STORE_NAME,''));
update PRODUCT_SEARCH_INFO p inner join (select p2.PRODUCT_ID as PRODUCT_ID,  p2.SKU as SKU, p2.CAS as CAS, p2.CODE as CODE, pdscp.NAME as NAME, pdscp.EN_NAME as EN_NAME, m.STORE_NAME as STORE_NAME from PRODUCT_SEARCH_INFO p1 left join PRODUCT p2 on p1.PRODUCT_ID=p2.PRODUCT_ID left join PRODUCT_DESCRIPTION pdscp on p2.PRODUCT_ID=pdscp.PRODUCT_ID left join MERCHANT_STORE m on m.MERCHANT_ID=p2.MERCHANT_ID where p1.SEARCH_CONTENT is null limit 300000) as d on d.PRODUCT_ID=p.PRODUCT_ID set p.SEARCH_CONTENT=concat(IFNULL(d.SKU,''), IFNULL(d.CAS,''), IFNULL(d.CODE,''), IFNULL(d.NAME,''), IFNULL(d.EN_NAME,''), IFNULL(d.STORE_NAME,''));
update PRODUCT_SEARCH_INFO p inner join (select p2.PRODUCT_ID as PRODUCT_ID,  p2.SKU as SKU, p2.CAS as CAS, p2.CODE as CODE, pdscp.NAME as NAME, pdscp.EN_NAME as EN_NAME, m.STORE_NAME as STORE_NAME from PRODUCT_SEARCH_INFO p1 left join PRODUCT p2 on p1.PRODUCT_ID=p2.PRODUCT_ID left join PRODUCT_DESCRIPTION pdscp on p2.PRODUCT_ID=pdscp.PRODUCT_ID left join MERCHANT_STORE m on m.MERCHANT_ID=p2.MERCHANT_ID where p1.SEARCH_CONTENT is null limit 300000) as d on d.PRODUCT_ID=p.PRODUCT_ID set p.SEARCH_CONTENT=concat(IFNULL(d.SKU,''), IFNULL(d.CAS,''), IFNULL(d.CODE,''), IFNULL(d.NAME,''), IFNULL(d.EN_NAME,''), IFNULL(d.STORE_NAME,''));
update PRODUCT_SEARCH_INFO p inner join (select p2.PRODUCT_ID as PRODUCT_ID,  p2.SKU as SKU, p2.CAS as CAS, p2.CODE as CODE, pdscp.NAME as NAME, pdscp.EN_NAME as EN_NAME, m.STORE_NAME as STORE_NAME from PRODUCT_SEARCH_INFO p1 left join PRODUCT p2 on p1.PRODUCT_ID=p2.PRODUCT_ID left join PRODUCT_DESCRIPTION pdscp on p2.PRODUCT_ID=pdscp.PRODUCT_ID left join MERCHANT_STORE m on m.MERCHANT_ID=p2.MERCHANT_ID where p1.SEARCH_CONTENT is null limit 300000) as d on d.PRODUCT_ID=p.PRODUCT_ID set p.SEARCH_CONTENT=concat(IFNULL(d.SKU,''), IFNULL(d.CAS,''), IFNULL(d.CODE,''), IFNULL(d.NAME,''), IFNULL(d.EN_NAME,''), IFNULL(d.STORE_NAME,''));
update PRODUCT_SEARCH_INFO p inner join (select p2.PRODUCT_ID as PRODUCT_ID,  p2.SKU as SKU, p2.CAS as CAS, p2.CODE as CODE, pdscp.NAME as NAME, pdscp.EN_NAME as EN_NAME, m.STORE_NAME as STORE_NAME from PRODUCT_SEARCH_INFO p1 left join PRODUCT p2 on p1.PRODUCT_ID=p2.PRODUCT_ID left join PRODUCT_DESCRIPTION pdscp on p2.PRODUCT_ID=pdscp.PRODUCT_ID left join MERCHANT_STORE m on m.MERCHANT_ID=p2.MERCHANT_ID where p1.SEARCH_CONTENT is null limit 300000) as d on d.PRODUCT_ID=p.PRODUCT_ID set p.SEARCH_CONTENT=concat(IFNULL(d.SKU,''), IFNULL(d.CAS,''), IFNULL(d.CODE,''), IFNULL(d.NAME,''), IFNULL(d.EN_NAME,''), IFNULL(d.STORE_NAME,''));
update PRODUCT_SEARCH_INFO p inner join (select p2.PRODUCT_ID as PRODUCT_ID,  p2.SKU as SKU, p2.CAS as CAS, p2.CODE as CODE, pdscp.NAME as NAME, pdscp.EN_NAME as EN_NAME, m.STORE_NAME as STORE_NAME from PRODUCT_SEARCH_INFO p1 left join PRODUCT p2 on p1.PRODUCT_ID=p2.PRODUCT_ID left join PRODUCT_DESCRIPTION pdscp on p2.PRODUCT_ID=pdscp.PRODUCT_ID left join MERCHANT_STORE m on m.MERCHANT_ID=p2.MERCHANT_ID where p1.SEARCH_CONTENT is null limit 300000) as d on d.PRODUCT_ID=p.PRODUCT_ID set p.SEARCH_CONTENT=concat(IFNULL(d.SKU,''), IFNULL(d.CAS,''), IFNULL(d.CODE,''), IFNULL(d.NAME,''), IFNULL(d.EN_NAME,''), IFNULL(d.STORE_NAME,''));
update PRODUCT_SEARCH_INFO p inner join (select p2.PRODUCT_ID as PRODUCT_ID,  p2.SKU as SKU, p2.CAS as CAS, p2.CODE as CODE, pdscp.NAME as NAME, pdscp.EN_NAME as EN_NAME, m.STORE_NAME as STORE_NAME from PRODUCT_SEARCH_INFO p1 left join PRODUCT p2 on p1.PRODUCT_ID=p2.PRODUCT_ID left join PRODUCT_DESCRIPTION pdscp on p2.PRODUCT_ID=pdscp.PRODUCT_ID left join MERCHANT_STORE m on m.MERCHANT_ID=p2.MERCHANT_ID where p1.SEARCH_CONTENT is null limit 300000) as d on d.PRODUCT_ID=p.PRODUCT_ID set p.SEARCH_CONTENT=concat(IFNULL(d.SKU,''), IFNULL(d.CAS,''), IFNULL(d.CODE,''), IFNULL(d.NAME,''), IFNULL(d.EN_NAME,''), IFNULL(d.STORE_NAME,''));
update PRODUCT_SEARCH_INFO p inner join (select p2.PRODUCT_ID as PRODUCT_ID,  p2.SKU as SKU, p2.CAS as CAS, p2.CODE as CODE, pdscp.NAME as NAME, pdscp.EN_NAME as EN_NAME, m.STORE_NAME as STORE_NAME from PRODUCT_SEARCH_INFO p1 left join PRODUCT p2 on p1.PRODUCT_ID=p2.PRODUCT_ID left join PRODUCT_DESCRIPTION pdscp on p2.PRODUCT_ID=pdscp.PRODUCT_ID left join MERCHANT_STORE m on m.MERCHANT_ID=p2.MERCHANT_ID where p1.SEARCH_CONTENT is null limit 300000) as d on d.PRODUCT_ID=p.PRODUCT_ID set p.SEARCH_CONTENT=concat(IFNULL(d.SKU,''), IFNULL(d.CAS,''), IFNULL(d.CODE,''), IFNULL(d.NAME,''), IFNULL(d.EN_NAME,''), IFNULL(d.STORE_NAME,''));
update PRODUCT_SEARCH_INFO p inner join (select p2.PRODUCT_ID as PRODUCT_ID,  p2.SKU as SKU, p2.CAS as CAS, p2.CODE as CODE, pdscp.NAME as NAME, pdscp.EN_NAME as EN_NAME, m.STORE_NAME as STORE_NAME from PRODUCT_SEARCH_INFO p1 left join PRODUCT p2 on p1.PRODUCT_ID=p2.PRODUCT_ID left join PRODUCT_DESCRIPTION pdscp on p2.PRODUCT_ID=pdscp.PRODUCT_ID left join MERCHANT_STORE m on m.MERCHANT_ID=p2.MERCHANT_ID where p1.SEARCH_CONTENT is null limit 300000) as d on d.PRODUCT_ID=p.PRODUCT_ID set p.SEARCH_CONTENT=concat(IFNULL(d.SKU,''), IFNULL(d.CAS,''), IFNULL(d.CODE,''), IFNULL(d.NAME,''), IFNULL(d.EN_NAME,''), IFNULL(d.STORE_NAME,''));
update PRODUCT_SEARCH_INFO p inner join (select p2.PRODUCT_ID as PRODUCT_ID,  p2.SKU as SKU, p2.CAS as CAS, p2.CODE as CODE, pdscp.NAME as NAME, pdscp.EN_NAME as EN_NAME, m.STORE_NAME as STORE_NAME from PRODUCT_SEARCH_INFO p1 left join PRODUCT p2 on p1.PRODUCT_ID=p2.PRODUCT_ID left join PRODUCT_DESCRIPTION pdscp on p2.PRODUCT_ID=pdscp.PRODUCT_ID left join MERCHANT_STORE m on m.MERCHANT_ID=p2.MERCHANT_ID where p1.SEARCH_CONTENT is null limit 300000) as d on d.PRODUCT_ID=p.PRODUCT_ID set p.SEARCH_CONTENT=concat(IFNULL(d.SKU,''), IFNULL(d.CAS,''), IFNULL(d.CODE,''), IFNULL(d.NAME,''), IFNULL(d.EN_NAME,''), IFNULL(d.STORE_NAME,''));
update PRODUCT_SEARCH_INFO p inner join (select p2.PRODUCT_ID as PRODUCT_ID,  p2.SKU as SKU, p2.CAS as CAS, p2.CODE as CODE, pdscp.NAME as NAME, pdscp.EN_NAME as EN_NAME, m.STORE_NAME as STORE_NAME from PRODUCT_SEARCH_INFO p1 left join PRODUCT p2 on p1.PRODUCT_ID=p2.PRODUCT_ID left join PRODUCT_DESCRIPTION pdscp on p2.PRODUCT_ID=pdscp.PRODUCT_ID left join MERCHANT_STORE m on m.MERCHANT_ID=p2.MERCHANT_ID where p1.SEARCH_CONTENT is null limit 300000) as d on d.PRODUCT_ID=p.PRODUCT_ID set p.SEARCH_CONTENT=concat(IFNULL(d.SKU,''), IFNULL(d.CAS,''), IFNULL(d.CODE,''), IFNULL(d.NAME,''), IFNULL(d.EN_NAME,''), IFNULL(d.STORE_NAME,''));
update PRODUCT_SEARCH_INFO p inner join (select p2.PRODUCT_ID as PRODUCT_ID,  p2.SKU as SKU, p2.CAS as CAS, p2.CODE as CODE, pdscp.NAME as NAME, pdscp.EN_NAME as EN_NAME, m.STORE_NAME as STORE_NAME from PRODUCT_SEARCH_INFO p1 left join PRODUCT p2 on p1.PRODUCT_ID=p2.PRODUCT_ID left join PRODUCT_DESCRIPTION pdscp on p2.PRODUCT_ID=pdscp.PRODUCT_ID left join MERCHANT_STORE m on m.MERCHANT_ID=p2.MERCHANT_ID where p1.SEARCH_CONTENT is null limit 300000) as d on d.PRODUCT_ID=p.PRODUCT_ID set p.SEARCH_CONTENT=concat(IFNULL(d.SKU,''), IFNULL(d.CAS,''), IFNULL(d.CODE,''), IFNULL(d.NAME,''), IFNULL(d.EN_NAME,''), IFNULL(d.STORE_NAME,''));
update PRODUCT_SEARCH_INFO p inner join (select p2.PRODUCT_ID as PRODUCT_ID,  p2.SKU as SKU, p2.CAS as CAS, p2.CODE as CODE, pdscp.NAME as NAME, pdscp.EN_NAME as EN_NAME, m.STORE_NAME as STORE_NAME from PRODUCT_SEARCH_INFO p1 left join PRODUCT p2 on p1.PRODUCT_ID=p2.PRODUCT_ID left join PRODUCT_DESCRIPTION pdscp on p2.PRODUCT_ID=pdscp.PRODUCT_ID left join MERCHANT_STORE m on m.MERCHANT_ID=p2.MERCHANT_ID where p1.SEARCH_CONTENT is null limit 300000) as d on d.PRODUCT_ID=p.PRODUCT_ID set p.SEARCH_CONTENT=concat(IFNULL(d.SKU,''), IFNULL(d.CAS,''), IFNULL(d.CODE,''), IFNULL(d.NAME,''), IFNULL(d.EN_NAME,''), IFNULL(d.STORE_NAME,''));
update PRODUCT_SEARCH_INFO p inner join (select p2.PRODUCT_ID as PRODUCT_ID,  p2.SKU as SKU, p2.CAS as CAS, p2.CODE as CODE, pdscp.NAME as NAME, pdscp.EN_NAME as EN_NAME, m.STORE_NAME as STORE_NAME from PRODUCT_SEARCH_INFO p1 left join PRODUCT p2 on p1.PRODUCT_ID=p2.PRODUCT_ID left join PRODUCT_DESCRIPTION pdscp on p2.PRODUCT_ID=pdscp.PRODUCT_ID left join MERCHANT_STORE m on m.MERCHANT_ID=p2.MERCHANT_ID where p1.SEARCH_CONTENT is null limit 300000) as d on d.PRODUCT_ID=p.PRODUCT_ID set p.SEARCH_CONTENT=concat(IFNULL(d.SKU,''), IFNULL(d.CAS,''), IFNULL(d.CODE,''), IFNULL(d.NAME,''), IFNULL(d.EN_NAME,''), IFNULL(d.STORE_NAME,''));
update PRODUCT_SEARCH_INFO p inner join (select p2.PRODUCT_ID as PRODUCT_ID,  p2.SKU as SKU, p2.CAS as CAS, p2.CODE as CODE, pdscp.NAME as NAME, pdscp.EN_NAME as EN_NAME, m.STORE_NAME as STORE_NAME from PRODUCT_SEARCH_INFO p1 left join PRODUCT p2 on p1.PRODUCT_ID=p2.PRODUCT_ID left join PRODUCT_DESCRIPTION pdscp on p2.PRODUCT_ID=pdscp.PRODUCT_ID left join MERCHANT_STORE m on m.MERCHANT_ID=p2.MERCHANT_ID where p1.SEARCH_CONTENT is null limit 300000) as d on d.PRODUCT_ID=p.PRODUCT_ID set p.SEARCH_CONTENT=concat(IFNULL(d.SKU,''), IFNULL(d.CAS,''), IFNULL(d.CODE,''), IFNULL(d.NAME,''), IFNULL(d.EN_NAME,''), IFNULL(d.STORE_NAME,''));
update PRODUCT_SEARCH_INFO p inner join (select p2.PRODUCT_ID as PRODUCT_ID,  p2.SKU as SKU, p2.CAS as CAS, p2.CODE as CODE, pdscp.NAME as NAME, pdscp.EN_NAME as EN_NAME, m.STORE_NAME as STORE_NAME from PRODUCT_SEARCH_INFO p1 left join PRODUCT p2 on p1.PRODUCT_ID=p2.PRODUCT_ID left join PRODUCT_DESCRIPTION pdscp on p2.PRODUCT_ID=pdscp.PRODUCT_ID left join MERCHANT_STORE m on m.MERCHANT_ID=p2.MERCHANT_ID where p1.SEARCH_CONTENT is null limit 300000) as d on d.PRODUCT_ID=p.PRODUCT_ID set p.SEARCH_CONTENT=concat(IFNULL(d.SKU,''), IFNULL(d.CAS,''), IFNULL(d.CODE,''), IFNULL(d.NAME,''), IFNULL(d.EN_NAME,''), IFNULL(d.STORE_NAME,''));
update PRODUCT_SEARCH_INFO p inner join (select p2.PRODUCT_ID as PRODUCT_ID,  p2.SKU as SKU, p2.CAS as CAS, p2.CODE as CODE, pdscp.NAME as NAME, pdscp.EN_NAME as EN_NAME, m.STORE_NAME as STORE_NAME from PRODUCT_SEARCH_INFO p1 left join PRODUCT p2 on p1.PRODUCT_ID=p2.PRODUCT_ID left join PRODUCT_DESCRIPTION pdscp on p2.PRODUCT_ID=pdscp.PRODUCT_ID left join MERCHANT_STORE m on m.MERCHANT_ID=p2.MERCHANT_ID where p1.SEARCH_CONTENT is null limit 300000) as d on d.PRODUCT_ID=p.PRODUCT_ID set p.SEARCH_CONTENT=concat(IFNULL(d.SKU,''), IFNULL(d.CAS,''), IFNULL(d.CODE,''), IFNULL(d.NAME,''), IFNULL(d.EN_NAME,''), IFNULL(d.STORE_NAME,''));
update PRODUCT_SEARCH_INFO p inner join (select p2.PRODUCT_ID as PRODUCT_ID,  p2.SKU as SKU, p2.CAS as CAS, p2.CODE as CODE, pdscp.NAME as NAME, pdscp.EN_NAME as EN_NAME, m.STORE_NAME as STORE_NAME from PRODUCT_SEARCH_INFO p1 left join PRODUCT p2 on p1.PRODUCT_ID=p2.PRODUCT_ID left join PRODUCT_DESCRIPTION pdscp on p2.PRODUCT_ID=pdscp.PRODUCT_ID left join MERCHANT_STORE m on m.MERCHANT_ID=p2.MERCHANT_ID where p1.SEARCH_CONTENT is null limit 300000) as d on d.PRODUCT_ID=p.PRODUCT_ID set p.SEARCH_CONTENT=concat(IFNULL(d.SKU,''), IFNULL(d.CAS,''), IFNULL(d.CODE,''), IFNULL(d.NAME,''), IFNULL(d.EN_NAME,''), IFNULL(d.STORE_NAME,''));
update PRODUCT_SEARCH_INFO p inner join (select p2.PRODUCT_ID as PRODUCT_ID,  p2.SKU as SKU, p2.CAS as CAS, p2.CODE as CODE, pdscp.NAME as NAME, pdscp.EN_NAME as EN_NAME, m.STORE_NAME as STORE_NAME from PRODUCT_SEARCH_INFO p1 left join PRODUCT p2 on p1.PRODUCT_ID=p2.PRODUCT_ID left join PRODUCT_DESCRIPTION pdscp on p2.PRODUCT_ID=pdscp.PRODUCT_ID left join MERCHANT_STORE m on m.MERCHANT_ID=p2.MERCHANT_ID where p1.SEARCH_CONTENT is null limit 300000) as d on d.PRODUCT_ID=p.PRODUCT_ID set p.SEARCH_CONTENT=concat(IFNULL(d.SKU,''), IFNULL(d.CAS,''), IFNULL(d.CODE,''), IFNULL(d.NAME,''), IFNULL(d.EN_NAME,''), IFNULL(d.STORE_NAME,''));

